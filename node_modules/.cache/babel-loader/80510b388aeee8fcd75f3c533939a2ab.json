{"ast":null,"code":"import _regeneratorRuntime from\"/Users/pratyas/Documents/MobileAppProject/MymobileApp/TOTRun/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/pratyas/Documents/MobileAppProject/MymobileApp/TOTRun/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/pratyas/Documents/MobileAppProject/MymobileApp/TOTRun/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Plugins}from\"@capacitor/core\";import{IonPage,IonHeader,IonToolbar,IonTitle,IonButton,IonButtons,IonContent,IonLoading,useIonViewDidEnter}from'@ionic/react';var Geolocation=Plugins.Geolocation;var Tab3=function Tab3(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showLoading=_useState2[0],setShowLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),positionReady=_useState4[0],setPositionReady=_useState4[1];var _useState5=useState({lat:0,lng:0,time:0}),_useState6=_slicedToArray(_useState5,2),currentPosition=_useState6[0],setCurrentPosition=_useState6[1];var _useState7=useState({lat:0,lng:0}),_useState8=_slicedToArray(_useState7,2),startPosition=_useState8[0],setStartPosition=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),startReady=_useState10[0],setStartReady=_useState10[1];var _useState11=useState({time:0}),_useState12=_slicedToArray(_useState11,2),startStatus=_useState12[0],setStartStatus=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),totalDistance=_useState14[0],setTotalDistance=_useState14[1];useIonViewDidEnter(function(){//getDistance();\n});// const startGetGPS = async () => {\n//   console.log('Getting...startGetGPS');\n//   setShowLoading(true);\n//   let position1 = await Geolocation.getCurrentPosition();\n//   setShowLoading(false);\n//   setPositionReady(true);\n//   setCurrentPosition({\n//     lat: position1.coords.latitude,\n//     lng: position1.coords.longitude,\n//     time : position1.timestamp\n//   });\n//   if (startReady == true) {\n//     setStartPosition({\n//       lat: position1.coords.latitude,\n//       lng: position1.coords.longitude\n//     })\n//     setStartReady(false);\n//   }\n//   // let lat = position1.coords.latitude;\n//   // let lng = position1.coords.longitude;\n//   console.log('Current startGetGPS', startPosition.lat, startPosition.lng);\n//}\nvar timeoutID;var getGPS=function getGPS(){timeoutID=setTimeout(getPostion,1000);console.log(\"timeout :\",timeoutID);setPositionReady(true);};var ungetGPS=function ungetGPS(){console.log(\"untimeout :\",timeoutID);clearTimeout(timeoutID);};var getPostion=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var start_position,position1;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:start_position={lat:0,lng:0};console.log('**** getDistance ***');_context.next=4;return Geolocation.getCurrentPosition({maximumAge:5000,timeout:5000}).then(function(position){alert(position1);//setPositionReady(true);\nsetCurrentPosition({lat:position.coords.latitude,lng:position.coords.longitude,time:position.timestamp});var lat=position.coords.latitude;var lng=position.coords.longitude;start_position={lat:lat,lng:lng};alert(\"lat : \"+lat+\" lng : \"+lng);}).catch(function(error){//console.log('ไม่สามารถหาพิกัดได้ :', error.message);\nalert('ไม่สามารถหาพิกัดได้ :'+error.message);});case 4:position1=_context.sent;case 5:case\"end\":return _context.stop();}}},_callee);}));return function getPostion(){return _ref.apply(this,arguments);};}();var findDistance=function findDistance(position1,position2){var R=6373;// km\nvar lat1=position1.lat;var lng1=position1.lng;var lat2=position2.lat;var lng2=position2.lng;var dLat=toRad(lat2-lat1);var dLng=toRad(lng2-lng1);var a=Math.sin(dLat/2)*Math.sin(dLat/2)+toRad(Math.cos(lat1))*toRad(Math.cos(lat2))*Math.sin(dLng/2)*Math.sin(dLng/2);var c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));var d=R*c;function toRad(Value){/** Converts numeric degrees to radians */return Value*Math.PI/180;}/* ทศนิยม 2 ตำแหน่ง */var d_round_to_2nd=Number(d.toFixed(2));//return d_round_to_2nd;\nreturn d;};var stop_time;var stopWatchGPS=function stopWatchGPS(watchid){console.log('Watch ID : ',watchid);Geolocation.clearWatch({id:watchid});//setPositionReady(true);\n};var totaldistance=0;var watch1;var count=0;var sub_distance=0;var startWatchGPS=function startWatchGPS(){console.log(startStatus.time);var position_1={lat:0,lng:0};// จุดถัดมาจากการ GetGPS from Device\nvar position_2={lat:0,lng:0};// จุดถัดมาจากการ GetGPS from Device\ncount=count+1;console.log('*** startWatchGPS **** :',count);var countwatchpostion=0;watch1=Geolocation.watchPosition({},function(position,error){// {maximumAge:5000,timeout:5000}\nconsole.log('WatchID :',watch1);console.log('*** New Position ***',position.coords.latitude);console.log('*** New Position ***',position.coords.longitude);console.log('*** New Position ***',position.timestamp);console.log('CountWatchPostion :',countwatchpostion);//setPositionReady(true);\nposition_2={lat:position.coords.latitude,lng:position.coords.longitude};if(countwatchpostion==1){console.log('time stamp :',position.timestamp);setStartStatus({time:position.timestamp});}console.log('Position : ',position_1.lat,position_1.lng,position_2.lat,position_2.lng);console.log('Before :',sub_distance);if(position_1.lat>0){sub_distance=sub_distance+findDistance(position_1,position_2);}console.log('After: ',sub_distance);position_1=position_2;countwatchpostion=+1;});console.log(\"Total Distacne :\",sub_distance);};/* เพิ่มเลขศูนย์หน้า วัน เดือน เวลา ที่เป็นเลขหลักเดียว */var addZero=function addZero(i){if(i<'10'){i=\"0\"+i;}return i;};var getDatetime=function getDatetime(time){var myDate=new Date(time);var d=addZero(myDate.getDate());var m=addZero(myDate.getMonth()+1);var y=myDate.getFullYear();var h=addZero(myDate.getHours());var min=addZero(myDate.getMinutes());var sec=addZero(myDate.getSeconds());var times=d+'-'+m+'-'+y+' '+h+':'+min+':'+sec;return times;};var durationtime=function durationtime(timestart,timestop){var time=timestop-timestart;var mystartDate=new Date(timestart);var mystopDate=new Date(timestop);var myDate=new Date(time);var h=addZero(myDate.getHours())-7;var min=addZero(myDate.getMinutes());var sec=addZero(myDate.getSeconds());var times;if(h==0){times=min+':'+sec;}else{times=h+':'+min+':'+sec;}return times;};var calduration=function calduration(){var x=durationtime(1453467965439,1585492636444);console.log(x+\" น.\");};var calories=function calories(distance,weight){var cal=(weight*distance*1.036).toFixed(2);console.log(cal+\" Kcal\");return cal;};var calCalories=function calCalories(){var x=calories(308,78);console.log(x+\" Kcal.\");};var startTextJSX;if(positionReady==true){startTextJSX=React.createElement(\"p\",null,currentPosition.lat,\",\",currentPosition.lng);}else{startTextJSX=React.createElement(\"p\",null,\"\\u0E01\\u0E14\\u0E1B\\u0E38\\u0E48\\u0E21\\u0E1A\\u0E19\\u0E02\\u0E27\\u0E32\\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E23\\u0E30\\u0E1A\\u0E38\\u0E1E\\u0E34\\u0E01\\u0E31\\u0E14\\u0E02\\u0E2D\\u0E07\\u0E40\\u0E04\\u0E23\\u0E37\\u0E48\\u0E2D\\u0E07\");}var stopTextJSX;var distanceTextJSX;var start_time=getDatetime(startStatus.time);// let datetime = getDatetime(position1.timestamp);\n//let duration = durationtime(startStatus.time, currentPosition.time);\nif(positionReady==true){stopTextJSX=React.createElement(\"p\",null,\"Start Time = \",start_time,React.createElement(\"br\",null),\"Stop Time =  \",React.createElement(\"br\",null),React.createElement(\"br\",null));// distanceTextJSX = <p>totalDistance = {distance}</p>\n}else{stopTextJSX=React.createElement(\"p\",null,\"\\u0E01\\u0E14\\u0E1B\\u0E38\\u0E48\\u0E21\\u0E1A\\u0E19\\u0E02\\u0E27\\u0E32\\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E23\\u0E30\\u0E1A\\u0E38\\u0E1E\\u0E34\\u0E01\\u0E31\\u0E14\\u0E02\\u0E2D\\u0E07\\u0E40\\u0E04\\u0E23\\u0E37\\u0E48\\u0E2D\\u0E07\");}return React.createElement(IonPage,null,React.createElement(IonHeader,{translucent:true},React.createElement(IonToolbar,null,React.createElement(IonTitle,null,\"Easy Running#1\"),React.createElement(IonButtons,{slot:\"end\"},React.createElement(IonButton,{expand:\"full\",color:\"primary\",shape:\"round\",slot:\"start\",size:\"large\",onClick:function onClick(){getGPS();}},\"WatchGPS\"),React.createElement(IonButton,{expand:\"block\",color:\"secondary\",shape:\"round\",slot:\"start\",size:\"large\",onClick:function onClick(){ungetGPS();}},\"StopGPS\")))),React.createElement(IonContent,null,React.createElement(\"body\",null,React.createElement(\"div\",{style:{height:'90vh',width:'100%'}},stopTextJSX)),React.createElement(IonLoading,{isOpen:showLoading,message:\"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E02\\u0E2D\\u0E1E\\u0E34\\u0E01\\u0E31\\u0E14\"})));};export default Tab3;","map":{"version":3,"sources":["/Users/pratyas/Documents/MobileAppProject/MymobileApp/TOTRun/src/pages/Tab3.tsx"],"names":["React","useState","Plugins","IonPage","IonHeader","IonToolbar","IonTitle","IonButton","IonButtons","IonContent","IonLoading","useIonViewDidEnter","Geolocation","Tab3","props","showLoading","setShowLoading","positionReady","setPositionReady","lat","lng","time","currentPosition","setCurrentPosition","startPosition","setStartPosition","startReady","setStartReady","startStatus","setStartStatus","totalDistance","setTotalDistance","timeoutID","getGPS","setTimeout","getPostion","console","log","ungetGPS","clearTimeout","start_position","getCurrentPosition","maximumAge","timeout","then","position","alert","position1","coords","latitude","longitude","timestamp","catch","error","message","findDistance","position2","R","lat1","lng1","lat2","lng2","dLat","toRad","dLng","a","Math","sin","cos","c","atan2","sqrt","d","Value","PI","d_round_to_2nd","Number","toFixed","stop_time","stopWatchGPS","watchid","clearWatch","id","totaldistance","watch1","count","sub_distance","startWatchGPS","position_1","position_2","countwatchpostion","watchPosition","addZero","i","getDatetime","myDate","Date","getDate","m","getMonth","y","getFullYear","h","getHours","min","getMinutes","sec","getSeconds","times","durationtime","timestart","timestop","mystartDate","mystopDate","calduration","x","calories","distance","weight","cal","calCalories","startTextJSX","stopTextJSX","distanceTextJSX","start_time","height","width"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { locate, laptop, time, alarmOutline, star } from \"ionicons/icons\";\r\nimport { Plugins } from \"@capacitor/core\";\r\nimport GoogleMapReact from 'google-map-react';\r\nimport { RefresherEventDetail } from '@ionic/core';\r\nimport { start } from 'repl';\r\nimport { IonPage, IonHeader, IonToolbar, IonTitle, IonButton, IonIcon, IonButtons, IonContent, IonLoading, useIonViewDidEnter } from '@ionic/react';\r\nimport { RouteComponentProps, useHistory } from 'react-router';\r\nimport { strict } from 'assert';\r\nimport shareValue from \"../Models/share\";\r\nimport { get } from 'https';\r\n\r\n\r\nconst { Geolocation } = Plugins;\r\nconst Tab3: React.FC<RouteComponentProps> = (props) => {\r\n  const [showLoading, setShowLoading] = useState(false);\r\n  const [positionReady, setPositionReady] = useState(false);\r\n  const [currentPosition, setCurrentPosition] = useState({ lat: 0, lng: 0 ,time: 0});\r\n  const [startPosition, setStartPosition] = useState({ lat: 0, lng: 0 });\r\n  const [startReady, setStartReady] = useState(true);\r\n  const [startStatus, setStartStatus] = useState({time:0});\r\n  const [totalDistance, setTotalDistance] = useState(0);\r\n\r\n\r\n\r\n\r\n\r\n\r\n  useIonViewDidEnter(() => {\r\n    //getDistance();\r\n\r\n  });\r\n\r\n\r\n\r\n  // const startGetGPS = async () => {\r\n  //   console.log('Getting...startGetGPS');\r\n  //   setShowLoading(true);\r\n  //   let position1 = await Geolocation.getCurrentPosition();\r\n  //   setShowLoading(false);\r\n  //   setPositionReady(true);\r\n  //   setCurrentPosition({\r\n  //     lat: position1.coords.latitude,\r\n  //     lng: position1.coords.longitude,\r\n  //     time : position1.timestamp\r\n  //   });\r\n\r\n  //   if (startReady == true) {\r\n    \r\n  //     setStartPosition({\r\n  //       lat: position1.coords.latitude,\r\n  //       lng: position1.coords.longitude\r\n        \r\n  //     })\r\n  //     setStartReady(false);\r\n  //   }\r\n  //   // let lat = position1.coords.latitude;\r\n  //   // let lng = position1.coords.longitude;\r\n  //   console.log('Current startGetGPS', startPosition.lat, startPosition.lng);\r\n\r\n\r\n  //}\r\n  let timeoutID:any;\r\n  let getGPS = () =>{\r\n      timeoutID = setTimeout(getPostion,1000);\r\n      console.log(\"timeout :\",timeoutID)\r\n      setPositionReady(true);\r\n  }\r\n  \r\n  let ungetGPS =() =>{\r\n    console.log(\"untimeout :\",timeoutID) \r\n    clearTimeout(timeoutID);\r\n  }\r\n  \r\n\r\n  const getPostion = async () => {\r\n    let start_position = ({lat:0,lng:0})\r\n    console.log('**** getDistance ***');\r\n    let position1 = await Geolocation.getCurrentPosition({maximumAge:5000,timeout:5000}).then((position) => {\r\n      alert(position1);\r\n      //setPositionReady(true);\r\n      setCurrentPosition({\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude,\r\n        time: position.timestamp\r\n      });\r\n      let lat = position.coords.latitude;\r\n      let lng = position.coords.longitude;\r\n      start_position = {\r\n          lat : lat,\r\n          lng : lng\r\n      };\r\n      \r\n    alert(\"lat : \" + lat + \" lng : \" + lng);\r\n      })\r\n      .catch((error) => {\r\n        //console.log('ไม่สามารถหาพิกัดได้ :', error.message);\r\n        alert('ไม่สามารถหาพิกัดได้ :'+ error.message);\r\n      });\r\n\r\n      \r\n  }\r\n\r\n  let findDistance = (position1:any,position2:any) => {\r\n    let R = 6373; // km\r\n\r\n    let lat1 = position1.lat;\r\n    let lng1 = position1.lng;\r\n    let lat2 = position2.lat;\r\n    let lng2 = position2.lng;\r\n\r\n    let dLat = toRad((lat2 - lat1));\r\n    let dLng = toRad((lng2 - lng1));\r\n    let a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n      toRad(Math.cos(lat1)) * toRad(Math.cos(lat2)) *\r\n      Math.sin(dLng / 2) * Math.sin(dLng / 2);\r\n    let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    let d = R * c;\r\n    function toRad(Value: any) {\r\n      /** Converts numeric degrees to radians */\r\n      return Value * Math.PI / 180;\r\n    }\r\n    /* ทศนิยม 2 ตำแหน่ง */\r\n    let d_round_to_2nd = Number(d.toFixed(2));\r\n    //return d_round_to_2nd;\r\n    return d;\r\n  };\r\n  \r\n  let stop_time;\r\n  \r\n  let stopWatchGPS = (watchid:any) => {\r\n    console.log('Watch ID : ' ,watchid)\r\n    Geolocation.clearWatch({id:watchid});\r\n    \r\n    //setPositionReady(true);\r\n    \r\n  }\r\n  \r\n  let totaldistance = 0;\r\n  let watch1: any;\r\n  let count = 0;\r\n  let sub_distance = 0;\r\n  \r\n  \r\n  let startWatchGPS = () => {\r\n    \r\n    \r\n    console.log(startStatus.time);\r\n\r\n    let position_1 =({lat:0,lng:0});  // จุดถัดมาจากการ GetGPS from Device\r\n    let position_2 =({lat:0,lng:0});  // จุดถัดมาจากการ GetGPS from Device\r\n    \r\n    count = count + 1;\r\n    console.log('*** startWatchGPS **** :',count);\r\n    \r\n    let countwatchpostion = 0;\r\n    watch1 = Geolocation.watchPosition({}, (position, error) => {\r\n    // {maximumAge:5000,timeout:5000}\r\n    \r\n    console.log('WatchID :',watch1);\r\n    console.log('*** New Position ***', position.coords.latitude);\r\n    console.log('*** New Position ***', position.coords.longitude);\r\n    console.log('*** New Position ***', position.timestamp);\r\n    console.log('CountWatchPostion :',countwatchpostion);\r\n    \r\n    //setPositionReady(true);\r\n    \r\n    position_2 = ({\r\n      lat: position.coords.latitude,\r\n      lng: position.coords.longitude\r\n    });\r\n    if (countwatchpostion == 1) {\r\n      console.log('time stamp :' ,position.timestamp);\r\n      setStartStatus({\r\n         time :position.timestamp\r\n        })\r\n    }\r\n    console.log('Position : ',position_1.lat,position_1.lng,position_2.lat,position_2.lng)\r\n    console.log('Before :',sub_distance);\r\n    if (position_1.lat > 0) {\r\n      sub_distance = sub_distance + findDistance(position_1,position_2);\r\n    }\r\n    console.log('After: ',sub_distance);\r\n    position_1 = position_2;\r\n    countwatchpostion = +1;\r\n      \r\n    })\r\n    \r\n    console.log(\"Total Distacne :\",sub_distance);\r\n\r\n  }\r\n  \r\n\r\n\r\n\r\n\r\n  \r\n\r\n  \r\n  \r\n  /* เพิ่มเลขศูนย์หน้า วัน เดือน เวลา ที่เป็นเลขหลักเดียว */\r\n  let addZero = (i: any) => {\r\n    if (i < '10') {\r\n      i = \"0\" + i;\r\n    }\r\n    return i;\r\n  }\r\n\r\n  let getDatetime = (time: any) => {\r\n   \r\n    let myDate = new Date(time);\r\n    let d = addZero(myDate.getDate());\r\n    let m = addZero((myDate.getMonth()) + 1);\r\n    let y = myDate.getFullYear();\r\n    let h = addZero(myDate.getHours());\r\n    let min = addZero(myDate.getMinutes());\r\n    let sec = addZero(myDate.getSeconds());\r\n    let times = d + '-' + m + '-' + y + ' ' + h + ':' + min + ':' + sec\r\n  return times;\r\n  };\r\n\r\n  let durationtime = (timestart: any, timestop: any) => {\r\n    let time = timestop - timestart;\r\n    let mystartDate = new Date(timestart);\r\n    let mystopDate = new Date(timestop);\r\n    let myDate = new Date(time);\r\n    let h = addZero(myDate.getHours()) - 7;\r\n    let min = addZero(myDate.getMinutes());\r\n    let sec = addZero(myDate.getSeconds());\r\n    let times;\r\n    if (h == 0) {\r\n      times = min + ':' + sec\r\n    } else {\r\n      times = h + ':' + min + ':' + sec\r\n    }\r\n    return times;\r\n  };\r\n\r\n  let calduration = () => {\r\n    let x = durationtime(1453467965439, 1585492636444);\r\n    console.log(x + \" น.\")\r\n  }\r\n\r\n  let calories = (distance: any, weight: any) => {\r\n\r\n    let cal = (weight * distance * 1.036).toFixed(2)\r\n    console.log(cal + \" Kcal\")\r\n    return cal;\r\n\r\n  };\r\n  let calCalories = () => {\r\n    let x = calories(308, 78);\r\n    console.log(x + \" Kcal.\")\r\n  }\r\n\r\n  let startTextJSX;\r\n\r\n  if (positionReady == true) {\r\n    startTextJSX = <p>{currentPosition.lat},{currentPosition.lng}</p>\r\n  }\r\n  else {\r\n    startTextJSX = <p>กดปุ่มบนขวาเพื่อระบุพิกัดของเครื่อง</p>\r\n  }\r\n  let stopTextJSX;\r\n  let distanceTextJSX;\r\n  let start_time = getDatetime(startStatus.time);\r\n  \r\n  \r\n  \r\n  // let datetime = getDatetime(position1.timestamp);\r\n  //let duration = durationtime(startStatus.time, currentPosition.time);\r\n  \r\n\r\n  if (positionReady == true) {\r\n\r\n\r\n    stopTextJSX = <p>\r\n                    Start Time = {start_time}<br></br>\r\n                    Stop Time =  {}<br></br>\r\n                     <br></br>\r\n                    </p>\r\n\r\n    // distanceTextJSX = <p>totalDistance = {distance}</p>\r\n  } else {\r\n    stopTextJSX = <p>กดปุ่มบนขวาเพื่อระบุพิกัดของเครื่อง</p>\r\n  }\r\n\r\n  return (\r\n    <IonPage>\r\n      <IonHeader translucent={true}>\r\n        <IonToolbar>\r\n          <IonTitle>Easy Running#1</IonTitle>\r\n          <IonButtons slot=\"end\">\r\n            <IonButton expand=\"full\" color=\"primary\" shape=\"round\" slot=\"start\" size=\"large\" onClick={()=>{\r\n              \r\n              getGPS();\r\n            }} >WatchGPS</IonButton>\r\n            <IonButton expand=\"block\" color=\"secondary\" shape=\"round\" slot=\"start\" size=\"large\" onClick={()=>{\r\n              \r\n              \r\n              ungetGPS();\r\n            }}>StopGPS</IonButton>\r\n          </IonButtons>\r\n        </IonToolbar>\r\n      </IonHeader>\r\n      <IonContent>\r\n        <body >\r\n          <div style={{ height: '90vh', width: '100%' }}>\r\n\r\n            {stopTextJSX}\r\n            \r\n\r\n          </div>\r\n        </body>\r\n        <IonLoading isOpen={showLoading} message=\"กำลังขอพิกัด\" />\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\nexport default Tab3;"]},"metadata":{},"sourceType":"module"}